{% extends "base.html" %}
{% block content %}
<style>
  body {
    background: #f5f5f5;
    font-family: "Montserrat", sans-serif;
    position: relative;
  }

  /* Hero Carousel Container */
  .hero-carousel-container {
    width: 100%;
    overflow: hidden;
    margin-bottom: 40px;
    background: #fff;
    padding: 20px 0;
    position: relative;
  }

  .hero-carousel-wrapper {
    display: flex;
    width: 100%;
    overflow: hidden;
    position: relative;
  }

  .hero-carousel {
    display: flex;
    gap: 20px;
    min-width: max-content;
    animation: scroll-left 20s linear infinite;
  }

  @keyframes scroll-left {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }

  .hero-card {
    flex: 0 0 220px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .hero-card img {
    width: 100%;
    height: 260px;
    object-fit: contain; /* ensures image is not cut */
    border-radius: 12px;
  }

  /* Badges */
  .hero-badges {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 8px;
    z-index: 10;
  }

  .hero-badge {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #ccc;
    transition: background 0.3s;
  }

  .hero-badge.active {
    background: #b8860b; /* gold */
  }

  /* Categories */
  .categories {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
    margin-bottom: 50px;
  }

  .cat-card {
    flex: 1 1 220px;
    max-width: 260px;
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    overflow: hidden;
    text-align: center;
    transition: transform 0.3s, box-shadow 0.3s;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .cat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 35px rgba(0,0,0,0.15);
  }

  .cat-card h3 {
    font-size: 18px;
    margin: 10px 0;
    font-weight: 700;
    color: #b8860b;
  }

  .cat-card img {
    width: 100%;
    height: 150px;
    object-fit: cover;
  }

  /* Top Selling Products */
  .top-selling-products h2 {
    text-align: center;
    font-size: 2rem;
    font-weight: 800;
    margin-bottom: 28px;
    color: #b8860b;
    position: relative;
  }

  .top-selling-products h2::after {
    content: "";
    display: block;
    width: 60px;
    height: 4px;
    background: #b8860b;
    margin: 8px auto 0 auto;
    border-radius: 2px;
  }

  .products-cards {
    display: flex;
    gap: 24px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .products-cards .cat-card {
    max-width: 280px;
    padding: 20px;
  }

  .products-cards .hero-card {
    width: 100%;
    max-width: 220px;
    margin-bottom: 12px;
    border-radius: 12px;
    overflow: hidden;
    background: #f9f9f9;
  }

  .products-cards .hero-card img {
    width: 100%;
    height: 180px;
    object-fit: contain;
  }

  .products-cards .price {
    font-weight: 700;
    font-size: 16px;
    color: #333;
  }

  .add-to-cart-btn {
    margin-top: 12px;
    padding: 10px 20px;
    background: #b8860b;
    color: #fff;
    border: none;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.2s, transform 0.2s;
  }

  .add-to-cart-btn:hover {
    background: #a07715;
    transform: translateY(-2px);
  }

  /* About & Contact */
  .about h2,
  .contact h2 {
    color: #b8860b;
    font-size: 26px;
    margin-bottom: 12px;
    text-align: center;
  }

  .about p,
  .contact p {
    color: #333;
    font-size: 16px;
    max-width: 800px;
    margin: 0 auto 10px auto;
    line-height: 1.5;
    text-align: center;
  }

  /* Responsive */
  @media(max-width: 768px){
    .hero-card { flex: 0 0 160px; height: 140px; }
    .hero-card img { height: 140px; }
    .cat-card { max-width: 180px; margin: 0 auto; }
    .products-cards .hero-card img { height: 140px; }
  }
</style>
<!-- Cart Modal -->
<div id="cartModal" style="display:none; position:fixed; top:70px; right:20px; width:300px; max-height:400px; overflow-y:auto; background:#fff; box-shadow:0 4px 20px rgba(0,0,0,0.2); border-radius:12px; padding:16px; z-index:999;">
  <h3 style="text-align:center; margin-bottom:12px;">Your Cart</h3>
  <div id="cartItems"></div>
  <div style="text-align:center; margin-top:12px;">
    <button id="clearCartBtn" style="padding:8px 16px; background:#b8860b; color:#fff; border:none; border-radius:6px; cursor:pointer;">Clear Cart</button>
  </div>
</div>

<!-- Hero Carousel -->
<div class="hero-carousel-container">
  <div class="hero-carousel-wrapper">
    <div class="hero-carousel" id="heroCarousel">
      {% for i in range(2) %}
        <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/label3.JPG') }}" alt="Label 1"></div>
        <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/label5.JPG') }}" alt="Label 2"></div>
        <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/label2.JPG') }}" alt="Label 3"></div>
        <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/label7.JPG') }}" alt="Label 4"></div>
        <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/label1.JPG') }}" alt="Label 5"></div>
      {% endfor %}
    </div>
  </div>
  <div class="hero-badges" id="heroBadges">
    <span class="hero-badge active"></span>
    <span class="hero-badge"></span>
    <span class="hero-badge"></span>
    <span class="hero-badge"></span>
    <span class="hero-badge"></span>
  </div>
</div>

<!-- Categories -->
<section class="categories container">
  <div class="cat-card">
    <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/slide4.JPG') }}" alt="Face Care"></div>
    <h3>Face Care</h3>
  </div>
  <div class="cat-card">
    <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/slide5.JPG') }}" alt="Skin Care"></div>
    <h3>Skin Care</h3>
  </div>
  <div class="cat-card">
    <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/slide7.JPG') }}" alt="Hair Care"></div>
    <h3>Hair Care</h3>
  </div>
  <div class="cat-card">
    <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/slide6.JPG') }}" alt="Body Care"></div>
    <h3>Body Care</h3>
  </div>
</section>

<!-- Top Selling Products -->
<section class="top-selling-products container">
  <h2>Top Selling Products</h2>
  <div class="products-cards">
    {% for p in products %}
      <div class="cat-card">
        <div class="hero-card"><img src="{{ url_for('static', filename='css/uploads/' ~ p.image) }}" alt="{{ p.title }}"></div>
        <h3>{{ p.title }}</h3>
        {% if p.subtitle %}<p>{{ p.subtitle }}</p>{% endif %}
        <p class="price">Rs. {{ p.price }}</p>
        <button class="add-to-cart-btn">Add To Cart</button>
      </div>
    {% endfor %}
  </div>
</section>

<!-- About & Contact -->
<section id="about" class="container about">
  <h2>Our Story</h2>
  <p>Natural Bloom crafts herbal personal-care products using traditional Ayurvedic ingredients â€” designed to nourish and strengthen.</p>
</section>

<section id="contact" class="container contact">
  <h2>Contact</h2>
  <p>194, Sri Sakthi Nagar, Gandhinagar post, Kurinjipadi Taluk, Cuddalore - 607308</p>
  <p>Phone: +91-7449299859 | Email: naturalbloomcare@hotmail.com</p>
</section>

<script>
  // Hero badges highlighting
  const badges = document.querySelectorAll('.hero-badge');
  const totalCards = 5;
  let badgeIndex = 0;
  setInterval(() => {
    badges.forEach((b, i) => b.classList.toggle('active', i === badgeIndex));
    badgeIndex = (badgeIndex + 1) % totalCards;
  }, 2000);
</script>
<script>
  // Cart logic
  const cartIcon = document.getElementById('cartIcon');
  const cartModal = document.getElementById('cartModal');
  const cartItemsDiv = document.getElementById('cartItems');
  const clearCartBtn = document.getElementById('clearCartBtn');
  const cartCount = document.getElementById('cartCount');

  let cart = JSON.parse(localStorage.getItem('cart')) || [];

  function updateCartDisplay() {
    cartCount.textContent = cart.length;
    cartItemsDiv.innerHTML = '';
    if(cart.length === 0){
      cartItemsDiv.innerHTML = '<p style="text-align:center; color:#333;">Your cart is empty.</p>';
      return;
    }
    cart.forEach((item, index) => {
      const itemDiv = document.createElement('div');
      itemDiv.style.display = 'flex';
      itemDiv.style.alignItems = 'center';
      itemDiv.style.marginBottom = '8px';
      itemDiv.innerHTML = `
        <img src="${item.image}" style="width:50px; height:50px; object-fit:cover; border-radius:6px; margin-right:8px;">
        <div style="flex:1;">
          <strong>${item.title}</strong><br>
          Rs. ${item.price}
        </div>
        
        <button onclick="location.href='/checkout?title=${encodeURIComponent(item.title)}&price=${item.price}'"><style="padding:4px 8px; background:#d9534f; color:#fff; border:none; border-radius:6px; cursor:pointer;">Buy</button>


        <button data-index="${index}" style="padding:4px 8px; background:#d9534f; color:#fff; border:none; border-radius:6px; cursor:pointer;">Remove</button>
        
        `;

      cartItemsDiv.appendChild(itemDiv);
    });

    cartItemsDiv.querySelectorAll('button').forEach(btn => {
      btn.addEventListener('click', function(){
        const idx = this.dataset.index;
        if(this.textContent === 'Remove'){
          cart.splice(idx,1);
        } else {
          alert(`Purchased: ${cart[idx].title}`);
          cart.splice(idx,1);
        }
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartDisplay();
      });
    });
  }

  function addToCart(item){
    cart.push(item);
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartDisplay();
  }

  document.addEventListener('DOMContentLoaded', () => {
    // Add to cart buttons
    document.querySelectorAll('.add-to-cart-btn').forEach((btn) => {
      btn.addEventListener('click', () => {
        const card = btn.closest('.cat-card');
        const item = {
          title: card.querySelector('h3').textContent,
          price: card.querySelector('.price') ? card.querySelector('.price').textContent.replace('Rs. ','') : '0',
          image: card.querySelector('img').src
        };
        addToCart(item);
      });
    });

    // Toggle cart modal
    cartIcon.addEventListener('click', () => {
      cartModal.style.display = cartModal.style.display === 'none' ? 'block' : 'none';
    });

    // Clear cart
    clearCartBtn.addEventListener('click', () => {
      cart = [];
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCartDisplay();
    });

    updateCartDisplay();
  });
</script>

{% endblock %}
